{"ast":null,"code":"import _ol_ from '../../index.js';\nimport _ol_coordinate_ from '../../coordinate.js';\nimport _ol_dom_ from '../../dom.js';\nimport _ol_extent_ from '../../extent.js';\nimport _ol_renderer_canvas_Layer_ from '../canvas/layer.js';\nimport _ol_transform_ from '../../transform.js';\n/**\n * @constructor\n * @abstract\n * @extends {ol.renderer.canvas.Layer}\n * @param {ol.layer.Layer} layer Layer.\n */\n\nvar _ol_renderer_canvas_IntermediateCanvas_ = function (layer) {\n  _ol_renderer_canvas_Layer_.call(this, layer);\n  /**\n   * @protected\n   * @type {ol.Transform}\n   */\n\n\n  this.coordinateToCanvasPixelTransform = _ol_transform_.create();\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n\n  this.hitCanvasContext_ = null;\n};\n\n_ol_.inherits(_ol_renderer_canvas_IntermediateCanvas_, _ol_renderer_canvas_Layer_);\n/**\n * @inheritDoc\n */\n\n\n_ol_renderer_canvas_IntermediateCanvas_.prototype.composeFrame = function (frameState, layerState, context) {\n  this.preCompose(context, frameState);\n  var image = this.getImage();\n\n  if (image) {\n    // clipped rendering if layer extent is set\n    var extent = layerState.extent;\n\n    var clipped = extent !== undefined && !_ol_extent_.containsExtent(extent, frameState.extent) && _ol_extent_.intersects(extent, frameState.extent);\n\n    if (clipped) {\n      this.clip(context, frameState,\n      /** @type {ol.Extent} */\n      extent);\n    }\n\n    var imageTransform = this.getImageTransform(); // for performance reasons, context.save / context.restore is not used\n    // to save and restore the transformation matrix and the opacity.\n    // see http://jsperf.com/context-save-restore-versus-variable\n\n    var alpha = context.globalAlpha;\n    context.globalAlpha = layerState.opacity; // for performance reasons, context.setTransform is only used\n    // when the view is rotated. see http://jsperf.com/canvas-transform\n\n    var dx = imageTransform[4];\n    var dy = imageTransform[5];\n    var dw = image.width * imageTransform[0];\n    var dh = image.height * imageTransform[3];\n    context.drawImage(image, 0, 0, +image.width, +image.height, Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n    context.globalAlpha = alpha;\n\n    if (clipped) {\n      context.restore();\n    }\n  }\n\n  this.postCompose(context, frameState, layerState);\n};\n/**\n * @abstract\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Canvas.\n */\n\n\n_ol_renderer_canvas_IntermediateCanvas_.prototype.getImage = function () {};\n/**\n * @abstract\n * @return {!ol.Transform} Image transform.\n */\n\n\n_ol_renderer_canvas_IntermediateCanvas_.prototype.getImageTransform = function () {};\n/**\n * @inheritDoc\n */\n\n\n_ol_renderer_canvas_IntermediateCanvas_.prototype.forEachFeatureAtCoordinate = function (coordinate, frameState, hitTolerance, callback, thisArg) {\n  var layer = this.getLayer();\n  var source = layer.getSource();\n  var resolution = frameState.viewState.resolution;\n  var rotation = frameState.viewState.rotation;\n  var skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n  /**\n   * @param {ol.Feature|ol.render.Feature} feature Feature.\n   * @return {?} Callback result.\n   */\n  function (feature) {\n    return callback.call(thisArg, feature, layer);\n  });\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_renderer_canvas_IntermediateCanvas_.prototype.forEachLayerAtCoordinate = function (coordinate, frameState, callback, thisArg) {\n  if (!this.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== _ol_.nullFunction) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    return _ol_renderer_canvas_Layer_.prototype.forEachLayerAtCoordinate.apply(this, arguments);\n  } else {\n    var pixel = _ol_transform_.apply(this.coordinateToCanvasPixelTransform, coordinate.slice());\n\n    _ol_coordinate_.scale(pixel, frameState.viewState.resolution / this.renderedResolution);\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = _ol_dom_.createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.getImage(), pixel[0], pixel[1], 1, 1, 0, 0, 1, 1);\n    var imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(), imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\n\nexport default _ol_renderer_canvas_IntermediateCanvas_;","map":{"version":3,"sources":["C:/xampp/htdocs/food_menu/node_modules/ol/renderer/canvas/intermediatecanvas.js"],"names":["_ol_","_ol_coordinate_","_ol_dom_","_ol_extent_","_ol_renderer_canvas_Layer_","_ol_transform_","_ol_renderer_canvas_IntermediateCanvas_","layer","call","coordinateToCanvasPixelTransform","create","hitCanvasContext_","inherits","prototype","composeFrame","frameState","layerState","context","preCompose","image","getImage","extent","clipped","undefined","containsExtent","intersects","clip","imageTransform","getImageTransform","alpha","globalAlpha","opacity","dx","dy","dw","width","dh","height","drawImage","Math","round","restore","postCompose","forEachFeatureAtCoordinate","coordinate","hitTolerance","callback","thisArg","getLayer","source","getSource","resolution","viewState","rotation","skippedFeatureUids","feature","forEachLayerAtCoordinate","nullFunction","apply","arguments","pixel","slice","scale","renderedResolution","createCanvasContext2D","clearRect","imageData","getImageData","data"],"mappings":"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","sourcesContent":["import _ol_ from '../../index.js';\nimport _ol_coordinate_ from '../../coordinate.js';\nimport _ol_dom_ from '../../dom.js';\nimport _ol_extent_ from '../../extent.js';\nimport _ol_renderer_canvas_Layer_ from '../canvas/layer.js';\nimport _ol_transform_ from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {ol.renderer.canvas.Layer}\n * @param {ol.layer.Layer} layer Layer.\n */\nvar _ol_renderer_canvas_IntermediateCanvas_ = function(layer) {\n\n  _ol_renderer_canvas_Layer_.call(this, layer);\n\n  /**\n   * @protected\n   * @type {ol.Transform}\n   */\n  this.coordinateToCanvasPixelTransform = _ol_transform_.create();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitCanvasContext_ = null;\n\n};\n\n_ol_.inherits(_ol_renderer_canvas_IntermediateCanvas_, _ol_renderer_canvas_Layer_);\n\n\n/**\n * @inheritDoc\n */\n_ol_renderer_canvas_IntermediateCanvas_.prototype.composeFrame = function(frameState, layerState, context) {\n\n  this.preCompose(context, frameState);\n\n  var image = this.getImage();\n  if (image) {\n\n    // clipped rendering if layer extent is set\n    var extent = layerState.extent;\n    var clipped = extent !== undefined &&\n        !_ol_extent_.containsExtent(extent, frameState.extent) &&\n        _ol_extent_.intersects(extent, frameState.extent);\n    if (clipped) {\n      this.clip(context, frameState, /** @type {ol.Extent} */ (extent));\n    }\n\n    var imageTransform = this.getImageTransform();\n    // for performance reasons, context.save / context.restore is not used\n    // to save and restore the transformation matrix and the opacity.\n    // see http://jsperf.com/context-save-restore-versus-variable\n    var alpha = context.globalAlpha;\n    context.globalAlpha = layerState.opacity;\n\n    // for performance reasons, context.setTransform is only used\n    // when the view is rotated. see http://jsperf.com/canvas-transform\n    var dx = imageTransform[4];\n    var dy = imageTransform[5];\n    var dw = image.width * imageTransform[0];\n    var dh = image.height * imageTransform[3];\n    context.drawImage(image, 0, 0, +image.width, +image.height,\n        Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n    context.globalAlpha = alpha;\n\n    if (clipped) {\n      context.restore();\n    }\n  }\n\n  this.postCompose(context, frameState, layerState);\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Canvas.\n */\n_ol_renderer_canvas_IntermediateCanvas_.prototype.getImage = function() {};\n\n\n/**\n * @abstract\n * @return {!ol.Transform} Image transform.\n */\n_ol_renderer_canvas_IntermediateCanvas_.prototype.getImageTransform = function() {};\n\n\n/**\n * @inheritDoc\n */\n_ol_renderer_canvas_IntermediateCanvas_.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  var layer = this.getLayer();\n  var source = layer.getSource();\n  var resolution = frameState.viewState.resolution;\n  var rotation = frameState.viewState.rotation;\n  var skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(\n      coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n      /**\n       * @param {ol.Feature|ol.render.Feature} feature Feature.\n       * @return {?} Callback result.\n       */\n      function(feature) {\n        return callback.call(thisArg, feature, layer);\n      });\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_renderer_canvas_IntermediateCanvas_.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, callback, thisArg) {\n  if (!this.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== _ol_.nullFunction) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    return _ol_renderer_canvas_Layer_.prototype.forEachLayerAtCoordinate.apply(this, arguments);\n  } else {\n    var pixel = _ol_transform_.apply(this.coordinateToCanvasPixelTransform, coordinate.slice());\n    _ol_coordinate_.scale(pixel, frameState.viewState.resolution / this.renderedResolution);\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = _ol_dom_.createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.getImage(), pixel[0], pixel[1], 1, 1, 0, 0, 1, 1);\n\n    var imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(),  imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\nexport default _ol_renderer_canvas_IntermediateCanvas_;\n"]},"metadata":{},"sourceType":"module"}