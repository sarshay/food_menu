{"ast":null,"code":"import _ol_ from '../../index.js';\nimport _ol_array_ from '../../array.js';\nimport _ol_color_ from '../../color.js';\nimport _ol_extent_ from '../../extent.js';\nimport _ol_obj_ from '../../obj.js';\nimport _ol_geom_flat_transform_ from '../../geom/flat/transform.js';\nimport _ol_render_webgl_circlereplay_defaultshader_ from '../webgl/circlereplay/defaultshader.js';\nimport _ol_render_webgl_circlereplay_defaultshader_Locations_ from '../webgl/circlereplay/defaultshader/locations.js';\nimport _ol_render_webgl_Replay_ from '../webgl/replay.js';\nimport _ol_render_webgl_ from '../webgl.js';\nimport _ol_webgl_ from '../../webgl.js';\nimport _ol_webgl_Buffer_ from '../../webgl/buffer.js';\n/**\n * @constructor\n * @extends {ol.render.webgl.Replay}\n * @param {number} tolerance Tolerance.\n * @param {ol.Extent} maxExtent Max extent.\n * @struct\n */\n\nvar _ol_render_webgl_CircleReplay_ = function (tolerance, maxExtent) {\n  _ol_render_webgl_Replay_.call(this, tolerance, maxExtent);\n  /**\n   * @private\n   * @type {ol.render.webgl.circlereplay.defaultshader.Locations}\n   */\n\n\n  this.defaultLocations_ = null;\n  /**\n   * @private\n   * @type {Array.<Array.<Array.<number>|number>>}\n   */\n\n  this.styles_ = [];\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n\n  this.styleIndices_ = [];\n  /**\n   * @private\n   * @type {number}\n   */\n\n  this.radius_ = 0;\n  /**\n   * @private\n   * @type {{fillColor: (Array.<number>|null),\n   *         strokeColor: (Array.<number>|null),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineWidth: (number|undefined),\n   *         changed: boolean}|null}\n   */\n\n  this.state_ = {\n    fillColor: null,\n    strokeColor: null,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineWidth: undefined,\n    changed: false\n  };\n};\n\n_ol_.inherits(_ol_render_webgl_CircleReplay_, _ol_render_webgl_Replay_);\n/**\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.drawCoordinates_ = function (flatCoordinates, offset, end, stride) {\n  var numVertices = this.vertices.length;\n  var numIndices = this.indices.length;\n  var n = numVertices / 4;\n  var i, ii;\n\n  for (i = offset, ii = end; i < ii; i += stride) {\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 0;\n    this.vertices[numVertices++] = this.radius_;\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 1;\n    this.vertices[numVertices++] = this.radius_;\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 2;\n    this.vertices[numVertices++] = this.radius_;\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 3;\n    this.vertices[numVertices++] = this.radius_;\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 3;\n    this.indices[numIndices++] = n;\n    n += 4;\n  }\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.drawCircle = function (circleGeometry, feature) {\n  var radius = circleGeometry.getRadius();\n  var stride = circleGeometry.getStride();\n\n  if (radius) {\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n\n    if (this.state_.changed) {\n      this.styleIndices_.push(this.indices.length);\n      this.state_.changed = false;\n    }\n\n    this.radius_ = radius;\n    var flatCoordinates = circleGeometry.getFlatCoordinates();\n    flatCoordinates = _ol_geom_flat_transform_.translate(flatCoordinates, 0, 2, stride, -this.origin[0], -this.origin[1]);\n    this.drawCoordinates_(flatCoordinates, 0, 2, stride);\n  } else {\n    if (this.state_.changed) {\n      this.styles_.pop();\n\n      if (this.styles_.length) {\n        var lastState = this.styles_[this.styles_.length - 1];\n        this.state_.fillColor =\n        /** @type {Array.<number>} */\n        lastState[0];\n        this.state_.strokeColor =\n        /** @type {Array.<number>} */\n        lastState[1];\n        this.state_.lineWidth =\n        /** @type {number} */\n        lastState[2];\n        this.state_.changed = false;\n      }\n    }\n  }\n};\n/**\n * @inheritDoc\n **/\n\n\n_ol_render_webgl_CircleReplay_.prototype.finish = function (context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new _ol_webgl_Buffer_(this.vertices); // create, bind, and populate the indices buffer\n\n  this.indicesBuffer = new _ol_webgl_Buffer_(this.indices);\n  this.startIndices.push(this.indices.length); //Clean up, if there is nothing to draw\n\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.getDeleteResourcesFunction = function (context) {\n  // We only delete our stuff here. The shaders and the program may\n  // be used by other CircleReplay instances (for other layers). And\n  // they will be deleted when disposing of the ol.webgl.Context\n  // object.\n  var verticesBuffer = this.verticesBuffer;\n  var indicesBuffer = this.indicesBuffer;\n  return function () {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.setUpProgram = function (gl, context, size, pixelRatio) {\n  // get the program\n  var fragmentShader, vertexShader;\n  fragmentShader = _ol_render_webgl_circlereplay_defaultshader_.fragment;\n  vertexShader = _ol_render_webgl_circlereplay_defaultshader_.vertex;\n  var program = context.getProgram(fragmentShader, vertexShader); // get the locations\n\n  var locations;\n\n  if (!this.defaultLocations_) {\n    locations = new _ol_render_webgl_circlereplay_defaultshader_Locations_(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program); // enable the vertex attrib arrays\n\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, _ol_webgl_.FLOAT, false, 16, 0);\n  gl.enableVertexAttribArray(locations.a_instruction);\n  gl.vertexAttribPointer(locations.a_instruction, 1, _ol_webgl_.FLOAT, false, 16, 8);\n  gl.enableVertexAttribArray(locations.a_radius);\n  gl.vertexAttribPointer(locations.a_radius, 1, _ol_webgl_.FLOAT, false, 16, 12); // Enable renderer specific uniforms.\n\n  gl.uniform2fv(locations.u_size, size);\n  gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n  return locations;\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.shutDownProgram = function (gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_instruction);\n  gl.disableVertexAttribArray(locations.a_radius);\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.drawReplay = function (gl, context, skippedFeaturesHash, hitDetection) {\n  if (!_ol_obj_.isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    var i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl,\n      /** @type {Array.<number>} */\n      nextStyle[0]);\n      this.setStrokeStyle_(gl,\n      /** @type {Array.<number>} */\n      nextStyle[1],\n      /** @type {number} */\n      nextStyle[2]);\n      this.drawElements(gl, context, start, end);\n      end = start;\n    }\n  }\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.drawHitDetectionReplayOneByOne = function (gl, context, skippedFeaturesHash, featureCallback, opt_hitExtent) {\n  var i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl,\n    /** @type {Array.<number>} */\n    nextStyle[0]);\n    this.setStrokeStyle_(gl,\n    /** @type {Array.<number>} */\n    nextStyle[1],\n    /** @type {number} */\n    nextStyle[2]);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 && this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = _ol_.getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined && feature.getGeometry() && (opt_hitExtent === undefined || _ol_extent_.intersects(\n      /** @type {Array<number>} */\n      opt_hitExtent, feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n        var result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n      }\n\n      featureIndex--;\n      end = start;\n    }\n  }\n\n  return undefined;\n};\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {ol.webgl.Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.drawReplaySkipping_ = function (gl, context, skippedFeaturesHash) {\n  var i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl,\n    /** @type {Array.<number>} */\n    nextStyle[0]);\n    this.setStrokeStyle_(gl,\n    /** @type {Array.<number>} */\n    nextStyle[1],\n    /** @type {number} */\n    nextStyle[2]);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 && this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = _ol_.getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n        }\n\n        end = featureStart;\n      }\n\n      featureIndex--;\n      start = featureStart;\n    }\n\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n    }\n\n    start = end = groupStart;\n  }\n};\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.setFillStyle_ = function (gl, color) {\n  gl.uniform4fv(this.defaultLocations_.u_fillColor, color);\n};\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n * @param {number} lineWidth Line width.\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.setStrokeStyle_ = function (gl, color, lineWidth) {\n  gl.uniform4fv(this.defaultLocations_.u_strokeColor, color);\n  gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n};\n/**\n * @inheritDoc\n */\n\n\n_ol_render_webgl_CircleReplay_.prototype.setFillStrokeStyle = function (fillStyle, strokeStyle) {\n  var strokeStyleColor, strokeStyleWidth;\n\n  if (strokeStyle) {\n    var strokeStyleLineDash = strokeStyle.getLineDash();\n    this.state_.lineDash = strokeStyleLineDash ? strokeStyleLineDash : _ol_render_webgl_.defaultLineDash;\n    var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    this.state_.lineDashOffset = strokeStyleLineDashOffset ? strokeStyleLineDashOffset : _ol_render_webgl_.defaultLineDashOffset;\n    strokeStyleColor = strokeStyle.getColor();\n\n    if (!(strokeStyleColor instanceof CanvasGradient) && !(strokeStyleColor instanceof CanvasPattern)) {\n      strokeStyleColor = _ol_color_.asArray(strokeStyleColor).map(function (c, i) {\n        return i != 3 ? c / 255 : c;\n      }) || _ol_render_webgl_.defaultStrokeStyle;\n    } else {\n      strokeStyleColor = _ol_render_webgl_.defaultStrokeStyle;\n    }\n\n    strokeStyleWidth = strokeStyle.getWidth();\n    strokeStyleWidth = strokeStyleWidth !== undefined ? strokeStyleWidth : _ol_render_webgl_.defaultLineWidth;\n  } else {\n    strokeStyleColor = [0, 0, 0, 0];\n    strokeStyleWidth = 0;\n  }\n\n  var fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n\n  if (!(fillStyleColor instanceof CanvasGradient) && !(fillStyleColor instanceof CanvasPattern)) {\n    fillStyleColor = _ol_color_.asArray(fillStyleColor).map(function (c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || _ol_render_webgl_.defaultFillStyle;\n  } else {\n    fillStyleColor = _ol_render_webgl_.defaultFillStyle;\n  }\n\n  if (!this.state_.strokeColor || !_ol_array_.equals(this.state_.strokeColor, strokeStyleColor) || !this.state_.fillColor || !_ol_array_.equals(this.state_.fillColor, fillStyleColor) || this.state_.lineWidth !== strokeStyleWidth) {\n    this.state_.changed = true;\n    this.state_.fillColor = fillStyleColor;\n    this.state_.strokeColor = strokeStyleColor;\n    this.state_.lineWidth = strokeStyleWidth;\n    this.styles_.push([fillStyleColor, strokeStyleColor, strokeStyleWidth]);\n  }\n};\n\nexport default _ol_render_webgl_CircleReplay_;","map":{"version":3,"sources":["C:/xampp/htdocs/food_menu/node_modules/ol/render/webgl/circlereplay.js"],"names":["_ol_","_ol_array_","_ol_color_","_ol_extent_","_ol_obj_","_ol_geom_flat_transform_","_ol_render_webgl_circlereplay_defaultshader_","_ol_render_webgl_circlereplay_defaultshader_Locations_","_ol_render_webgl_Replay_","_ol_render_webgl_","_ol_webgl_","_ol_webgl_Buffer_","_ol_render_webgl_CircleReplay_","tolerance","maxExtent","call","defaultLocations_","styles_","styleIndices_","radius_","state_","fillColor","strokeColor","lineDash","lineDashOffset","undefined","lineWidth","changed","inherits","prototype","drawCoordinates_","flatCoordinates","offset","end","stride","numVertices","vertices","length","numIndices","indices","n","i","ii","drawCircle","circleGeometry","feature","radius","getRadius","getStride","startIndices","push","startIndicesFeature","getFlatCoordinates","translate","origin","pop","lastState","finish","context","verticesBuffer","indicesBuffer","getDeleteResourcesFunction","deleteBuffer","setUpProgram","gl","size","pixelRatio","fragmentShader","vertexShader","fragment","vertex","program","getProgram","locations","useProgram","enableVertexAttribArray","a_position","vertexAttribPointer","FLOAT","a_instruction","a_radius","uniform2fv","u_size","uniform1f","u_pixelRatio","shutDownProgram","disableVertexAttribArray","drawReplay","skippedFeaturesHash","hitDetection","isEmpty","drawReplaySkipping_","start","nextStyle","setFillStyle_","setStrokeStyle_","drawElements","drawHitDetectionReplayOneByOne","featureCallback","opt_hitExtent","groupStart","featureUid","featureIndex","getUid","toString","getGeometry","intersects","getExtent","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","result","featureStart","color","uniform4fv","u_fillColor","u_strokeColor","u_lineWidth","setFillStrokeStyle","fillStyle","strokeStyle","strokeStyleColor","strokeStyleWidth","strokeStyleLineDash","getLineDash","defaultLineDash","strokeStyleLineDashOffset","getLineDashOffset","defaultLineDashOffset","getColor","CanvasGradient","CanvasPattern","asArray","map","c","defaultStrokeStyle","getWidth","defaultLineWidth","fillStyleColor","defaultFillStyle","equals"],"mappings":"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","sourcesContent":["import _ol_ from '../../index.js';\nimport _ol_array_ from '../../array.js';\nimport _ol_color_ from '../../color.js';\nimport _ol_extent_ from '../../extent.js';\nimport _ol_obj_ from '../../obj.js';\nimport _ol_geom_flat_transform_ from '../../geom/flat/transform.js';\nimport _ol_render_webgl_circlereplay_defaultshader_ from '../webgl/circlereplay/defaultshader.js';\nimport _ol_render_webgl_circlereplay_defaultshader_Locations_ from '../webgl/circlereplay/defaultshader/locations.js';\nimport _ol_render_webgl_Replay_ from '../webgl/replay.js';\nimport _ol_render_webgl_ from '../webgl.js';\nimport _ol_webgl_ from '../../webgl.js';\nimport _ol_webgl_Buffer_ from '../../webgl/buffer.js';\n\n/**\n * @constructor\n * @extends {ol.render.webgl.Replay}\n * @param {number} tolerance Tolerance.\n * @param {ol.Extent} maxExtent Max extent.\n * @struct\n */\nvar _ol_render_webgl_CircleReplay_ = function(tolerance, maxExtent) {\n  _ol_render_webgl_Replay_.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {ol.render.webgl.circlereplay.defaultshader.Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<Array.<number>|number>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.radius_ = 0;\n\n  /**\n   * @private\n   * @type {{fillColor: (Array.<number>|null),\n   *         strokeColor: (Array.<number>|null),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineWidth: (number|undefined),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    fillColor: null,\n    strokeColor: null,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineWidth: undefined,\n    changed: false\n  };\n\n};\n\n_ol_.inherits(_ol_render_webgl_CircleReplay_, _ol_render_webgl_Replay_);\n\n\n/**\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\n_ol_render_webgl_CircleReplay_.prototype.drawCoordinates_ = function(\n    flatCoordinates, offset, end, stride) {\n  var numVertices = this.vertices.length;\n  var numIndices = this.indices.length;\n  var n = numVertices / 4;\n  var i, ii;\n  for (i = offset, ii = end; i < ii; i += stride) {\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 0;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 1;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 2;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 3;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n + 2;\n\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 3;\n    this.indices[numIndices++] = n;\n\n    n += 4;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.drawCircle = function(circleGeometry, feature) {\n  var radius = circleGeometry.getRadius();\n  var stride = circleGeometry.getStride();\n  if (radius) {\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(this.indices.length);\n      this.state_.changed = false;\n    }\n\n    this.radius_ = radius;\n    var flatCoordinates = circleGeometry.getFlatCoordinates();\n    flatCoordinates = _ol_geom_flat_transform_.translate(flatCoordinates, 0, 2,\n        stride, -this.origin[0], -this.origin[1]);\n    this.drawCoordinates_(flatCoordinates, 0, 2, stride);\n  } else {\n    if (this.state_.changed) {\n      this.styles_.pop();\n      if (this.styles_.length) {\n        var lastState = this.styles_[this.styles_.length - 1];\n        this.state_.fillColor =  /** @type {Array.<number>} */ (lastState[0]);\n        this.state_.strokeColor = /** @type {Array.<number>} */ (lastState[1]);\n        this.state_.lineWidth = /** @type {number} */ (lastState[2]);\n        this.state_.changed = false;\n      }\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n **/\n_ol_render_webgl_CircleReplay_.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new _ol_webgl_Buffer_(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new _ol_webgl_Buffer_(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.getDeleteResourcesFunction = function(context) {\n  // We only delete our stuff here. The shaders and the program may\n  // be used by other CircleReplay instances (for other layers). And\n  // they will be deleted when disposing of the ol.webgl.Context\n  // object.\n  var verticesBuffer = this.verticesBuffer;\n  var indicesBuffer = this.indicesBuffer;\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  var fragmentShader, vertexShader;\n  fragmentShader = _ol_render_webgl_circlereplay_defaultshader_.fragment;\n  vertexShader = _ol_render_webgl_circlereplay_defaultshader_.vertex;\n  var program = context.getProgram(fragmentShader, vertexShader);\n\n  // get the locations\n  var locations;\n  if (!this.defaultLocations_) {\n    locations = new _ol_render_webgl_circlereplay_defaultshader_Locations_(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, _ol_webgl_.FLOAT,\n      false, 16, 0);\n\n  gl.enableVertexAttribArray(locations.a_instruction);\n  gl.vertexAttribPointer(locations.a_instruction, 1, _ol_webgl_.FLOAT,\n      false, 16, 8);\n\n  gl.enableVertexAttribArray(locations.a_radius);\n  gl.vertexAttribPointer(locations.a_radius, 1, _ol_webgl_.FLOAT,\n      false, 16, 12);\n\n  // Enable renderer specific uniforms.\n  gl.uniform2fv(locations.u_size, size);\n  gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_instruction);\n  gl.disableVertexAttribArray(locations.a_radius);\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  if (!_ol_obj_.isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    var i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n      this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n          /** @type {number} */ (nextStyle[2]));\n      this.drawElements(gl, context, start, end);\n      end = start;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n    featureCallback, opt_hitExtent) {\n  var i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n    this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n        /** @type {number} */ (nextStyle[2]));\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = _ol_.getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || _ol_extent_.intersects(\n              /** @type {Array<number>} */ (opt_hitExtent),\n              feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        var result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {ol.webgl.Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\n_ol_render_webgl_CircleReplay_.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  var i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n    this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n        /** @type {number} */ (nextStyle[2]));\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = _ol_.getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n */\n_ol_render_webgl_CircleReplay_.prototype.setFillStyle_ = function(gl, color) {\n  gl.uniform4fv(this.defaultLocations_.u_fillColor, color);\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n * @param {number} lineWidth Line width.\n */\n_ol_render_webgl_CircleReplay_.prototype.setStrokeStyle_ = function(gl, color, lineWidth) {\n  gl.uniform4fv(this.defaultLocations_.u_strokeColor, color);\n  gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_render_webgl_CircleReplay_.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  var strokeStyleColor, strokeStyleWidth;\n  if (strokeStyle) {\n    var strokeStyleLineDash = strokeStyle.getLineDash();\n    this.state_.lineDash = strokeStyleLineDash ?\n      strokeStyleLineDash : _ol_render_webgl_.defaultLineDash;\n    var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    this.state_.lineDashOffset = strokeStyleLineDashOffset ?\n      strokeStyleLineDashOffset : _ol_render_webgl_.defaultLineDashOffset;\n    strokeStyleColor = strokeStyle.getColor();\n    if (!(strokeStyleColor instanceof CanvasGradient) &&\n        !(strokeStyleColor instanceof CanvasPattern)) {\n      strokeStyleColor = _ol_color_.asArray(strokeStyleColor).map(function(c, i) {\n        return i != 3 ? c / 255 : c;\n      }) || _ol_render_webgl_.defaultStrokeStyle;\n    } else {\n      strokeStyleColor = _ol_render_webgl_.defaultStrokeStyle;\n    }\n    strokeStyleWidth = strokeStyle.getWidth();\n    strokeStyleWidth = strokeStyleWidth !== undefined ?\n      strokeStyleWidth : _ol_render_webgl_.defaultLineWidth;\n  } else {\n    strokeStyleColor = [0, 0, 0, 0];\n    strokeStyleWidth = 0;\n  }\n  var fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n  if (!(fillStyleColor instanceof CanvasGradient) &&\n      !(fillStyleColor instanceof CanvasPattern)) {\n    fillStyleColor = _ol_color_.asArray(fillStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || _ol_render_webgl_.defaultFillStyle;\n  } else {\n    fillStyleColor = _ol_render_webgl_.defaultFillStyle;\n  }\n  if (!this.state_.strokeColor || !_ol_array_.equals(this.state_.strokeColor, strokeStyleColor) ||\n      !this.state_.fillColor || !_ol_array_.equals(this.state_.fillColor, fillStyleColor) ||\n      this.state_.lineWidth !== strokeStyleWidth) {\n    this.state_.changed = true;\n    this.state_.fillColor = fillStyleColor;\n    this.state_.strokeColor = strokeStyleColor;\n    this.state_.lineWidth = strokeStyleWidth;\n    this.styles_.push([fillStyleColor, strokeStyleColor, strokeStyleWidth]);\n  }\n};\nexport default _ol_render_webgl_CircleReplay_;\n"]},"metadata":{},"sourceType":"module"}